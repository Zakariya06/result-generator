import { useSubject } from "../context/SubjectContext";

export default function MarksSheet() {
  const { subjects, studentsData } = useSubject();

  // ðŸ” Build column structure
  const columns = subjects.flatMap((s) => {
    const base = [
      {
        label: s.subject,
        key: s.subject,
      },
    ];

    if (s.ospe) {
      base.push({
        label: `${s.subject} - OSPE`,
        key: `${s.subject}-ospe`,
      });
    }

    return base;
  });

  console.log("this is student data");

  return (
    <div style={{ padding: "2.5rem 1.5rem" }}>
      <div
        className="cardLarge"
        style={{ overflowX: "auto", width: "100%", maxWidth: "100%" }}
      >
        <h2 style={{ textAlign: "center" }}>
          <span style={{ color: "a22840", display: "inline-block" }}>
            Khyber Medical University
          </span>{" "}
          - Peshawar
        </h2>

        <table className="customTable resultTable">
          <thead>
            {/* ===== ROW 1: MAIN HEADERS ===== */}
            <tr>
              <th rowSpan="2">S#</th>
              <th rowSpan="2">Roll #</th>
              <th rowSpan="2">Name</th>
              <th rowSpan="2">Fatherâ€™s Name</th>
              <th rowSpan="2">Registration</th>
              <th rowSpan="2">Discipline</th>
              <th rowSpan="2">Institute</th>

              {columns.map((col) => (
                <th key={col.key} colSpan="3">
                  {col.label}
                </th>
              ))}
            </tr>

            <tr>
              {columns.map((col) => (
                <>
                  <th key={`${col.key}-mid`}>Mid</th>
                  <th key={`${col.key}-final`}>Final</th>
                  <th key={`${col.key}-total`}>Total</th>
                </>
              ))}
            </tr>
          </thead>

          <tbody>
            <tr>
              <td>1</td>
              <td>KMU-001</td>
              <td>Student Name</td>
              <td>Father Name</td>
              <td>REG-2024</td>
              <td>Discipline Name</td>
              <td>KMU IHS-Swat</td>

              {columns.map((col) => (
                <>
                  <td>-</td>
                  <td>-</td>
                  <td>-</td>
                </>
              ))}
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  );
}
